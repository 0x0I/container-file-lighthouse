# Lighthouse :cloud: Compose

:octocat: Custom configuration of this deployment composition can be provided by setting environment variables of the operation environment explicitly:

`export image=0labs/lighthouse:v2.0.0`

or included within an environment config file located either at a `.beacon.env or .validator.env` file within the same directory or specified via one of the role type `env_vars` environment variables.

`export beacon_env_vars=/home/user/lighthouse/beacon.env`

## Config

**Required**

`none`

**Optional**

| var | description | default |
| --- | :---: | :---: |
| *image* | Lighthouse client container image to deploy | `0labs/lighthouse:latest` |
| *p2p_tcp_port* | peer-to-peer network communication and listening port | `9000` |
| *p2p_udp_port* | peer-to-peer network discovery port | `9000` |
| *beacon_api_port* | beacon node RESTful HTTP API listening port | `5052` |
| *beacon_metrics_port* | port used to listen and respond to metrics requests for prometheus | `5054` |
| *validator_api_port* | validator client RESTful HTTP API listening port | `5062` |
| *validator_metrics_port* | port used to listen and respond to metrics requests for prometheus | `5064` |
| *host_data_dir* | host directory to store node runtime/operational data | `/var/tmp/lighthouse` |
| *host_wallet_dir* | host directory to store node account wallets | `/var/tmp/lighthouse/wallets` |
| *host_keys_dir* | host directory to store node account keys | `/var/tmp/lighthouse/keys` |
| EXTRA_ARGS | command-line flags and options to include within lighthouse launch commands & subcommands | *see default environment files* | 
| *beacon_env_vars* | path to environment file containing `EXTRA_ARGS` to load by compose Beacon node container (see [here](https://github.com/sigp/lighthouse/issues/1876) for discovering available config options | `.beacon.env` |
| *validator_env_vars* | Path to environment file containing `EXTRA_ARGS` to load by compose Validator container (see [here](https://github.com/sigp/lighthouse/issues/1876) for discovering available config options | `.validator.env` |
| *restart_policy* | container restart policy | `unless-stopped` |

## Deploy examples

* Launch a Lighthouse beacon-chain node connected to the Prater Ethereum 2.0 testnet using a Goerli web3 Ethereum provider:
```
# cat .beacon.env
EXTRA_ARGS="--network=prater --eth1-endpoints=http://ethereum-rpc.goerli.01labs.net:8545"

docker-compose up lighthouse-beacon
```

* Customize the beacon chain node deploy container image and host + container data directory:
```
# cat .beacon.env
image=0labs/lighthouse:v2.0.1
host_data_dir=/my/host/data
EXTRA_ARGS="--datadir=/container/data/dir"

docker-compose up lighthouse-beacon
```

* Install Eth2 deposit CLI tool and automatically setup multiple validator accounts/keys to register on the Prater testnet:
```
# cat .beacon.env
SETUP_DEPOSIT_CLI=true
DEPOSIT_CLI_VERSION=v1.2.0
SETUP_DEPOSIT_ACCOUNTS=true
DEPOSIT_NUM_VALIDATORS=3
ETH2_CHAIN=prater
DEPOSIT_KEY_PASSWORD=ABCabc123!@#$

docker-compose up lighthouse-beacon
```

* Import one or more EIP-2335 passwords/keys generated by the eth2-deposit-cli Python utility into a Lighthouse VC directory:
```
# cat .validator.env
SETUP_VALIDATOR=true
host_keys_dir=/my/host/keys
VALIDATOR_KEYS_DIR=/keys # container path to mounted keys
VALIDATOR_KEYSTORE_PASSWORD=p@$$w0rd # password used to generate Ethereum 2.0 validator deposit keys
EXTRA_ARGS="--validators-dir=/keys"

docker-compose up lighthouse-validator
```
